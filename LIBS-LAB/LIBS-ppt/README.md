# LIBS煤标样数据分析系统

## 项目概述

本项目基于激光诱导击穿光谱（LIBS）技术，开发了煤质参数定量分析算法。通过机器学习方法，实现对煤炭关键质量指标（全硫、灰分、挥发分、热值、碳含量）的快速预测。

## 数据说明

### 输入数据
- **LIBS光谱数据**: `1064nm/` 目录下的10个煤标样光谱文件
  - 每个文件包含8个光谱通道（不同波长范围）
  - 从第7行开始，A列为波长，B列为强度
- **参考数据**: `煤标样.xlsx` 包含10个煤标样的真实值

### 目标属性
- 全硫 (St,d)
- 灰分 (Ad) 
- 挥发分 (Vd)
- 热值 (Qgr,d)
- 碳含量 (Cd)

## 算法流程

### 1. 数据预处理
```
原始光谱 → 异常值处理 → 平滑滤波 → 基线校正 → 归一化
```

**技术细节**:
- **异常值处理**: IQR方法检测和裁剪异常值
- **平滑滤波**: Savitzky-Golay滤波器（窗口长度7，多项式阶数3）
- **基线校正**: 5%分位数基线校正
- **归一化**: 最大值归一化

### 2. 特征提取
从每个光谱通道提取23个特征：

| 特征类型 | 特征名称 | 数量 |
|---------|---------|------|
| 统计特征 | 均值、标准差、最大值、最小值、中位数、分位数 | 7 |
| 积分特征 | 光谱面积 | 1 |
| 峰值特征 | 峰数量、平均峰高、峰高标准差、最高峰 | 4 |
| 矩特征 | 质心、光谱宽度、偏度、峰度 | 4 |
| 频域特征 | FFT均值、标准差、最大值 | 3 |
| 梯度特征 | 平均梯度、梯度标准差、最大梯度 | 3 |

**总特征数**: 8通道 × 23特征 = 184个特征

### 3. 特征选择
```
原始特征 → 常数特征移除 → 高相关特征移除 → 单变量选择 → 递归特征消除
```

**方法**:
- 移除方差为0的常数特征
- 移除相关系数>0.95的冗余特征  
- F统计量单变量特征选择
- 基于随机森林的递归特征消除

### 4. 模型构建
**算法对比**:
- Ridge回归（L2正则化）
- Lasso回归（L1正则化）
- ElasticNet回归（L1+L2正则化）
- 随机森林回归
- 支持向量回归（SVR）

**验证方法**:
- 留一法交叉验证（LOO-CV）
- 稳健标准化（RobustScaler）

## 使用方法

### 环境要求
```bash
pip install -r requirements.txt
```

### 运行分析
```bash
# 基础版本
python libs_analysis.py

# 改进版本（推荐）
python libs_analysis_improved.py
```

### 输出结果
- **可视化图表**: `results/` 或 `improved_results/` 目录
- **分析报告**: `LIBS分析报告.md` 或 `LIBS改进分析报告.md`

## 可视化结果

### 生成的图表
1. **原始光谱图**: 展示多通道光谱数据
2. **预处理效果对比图**: 对比预处理前后的光谱
3. **特征选择结果图**: 各属性选择的特征数量
4. **交叉验证结果图**: 模型性能评估
5. **模型性能对比图**: 不同算法的R²和RMSE对比
6. **预测结果散点图**: 真实值vs预测值
7. **特征重要性分析图**: 关键特征识别

## 算法优势

### 1. 多通道融合
- 充分利用8个光谱通道的信息
- 提取多维度光谱特征
- 增强信息的完整性

### 2. 智能特征工程
- 自动特征提取和选择
- 去除冗余和无关特征
- 降低维度灾难影响

### 3. 小样本优化
- 留一法交叉验证充分利用数据
- 正则化防止过拟合
- 稳健预处理提高鲁棒性

### 4. 全流程可视化
- 每个步骤都有可视化展示
- 便于理解和调试算法
- 支持结果解释和验证

## 性能评估

### 评估指标
- **R²得分**: 决定系数，衡量模型拟合优度
- **RMSE**: 均方根误差，衡量预测精度
- **交叉验证**: 评估模型泛化能力

### 小样本挑战
由于样本量有限（10个样本），存在以下挑战：
1. **维度灾难**: 特征数量远大于样本数量
2. **过拟合风险**: 模型容易记住训练数据
3. **泛化能力**: 难以评估真实预测性能

### 改进策略
1. **数据增强**: 收集更多样本数据
2. **特征降维**: PCA、LDA等降维技术
3. **集成学习**: 模型融合提高稳定性
4. **深度学习**: 1D-CNN等端到端学习

## 实际应用

### 适用场景
- 煤质快速检测
- 在线质量监控
- 煤炭分类分级
- 工业过程控制

### 部署建议
1. **硬件要求**: LIBS设备 + 计算平台
2. **软件集成**: 嵌入现有质检系统
3. **模型更新**: 定期重训练和校准
4. **质量控制**: 建立标准样品库

## 文件结构

```
LIBS-ppt/
├── 1064nm/                    # LIBS光谱数据目录
│   ├── 092A-1064nm.xlsx      # 样品光谱文件
│   ├── 098B-1064nm.xlsx
│   └── ...
├── 煤标样.xlsx                # 参考真实值数据
├── libs_analysis.py           # 基础分析算法
├── libs_analysis_improved.py  # 改进分析算法
├── requirements.txt           # Python依赖包
├── results/                   # 基础版结果目录
├── improved_results/          # 改进版结果目录
├── LIBS分析报告.md            # 基础版分析报告
├── LIBS改进分析报告.md        # 改进版分析报告
└── README.md                  # 项目说明文档
```

## 技术栈

- **Python 3.9+**
- **数据处理**: pandas, numpy
- **机器学习**: scikit-learn
- **信号处理**: scipy
- **可视化**: matplotlib, seaborn
- **文件处理**: openpyxl, xlrd

## 贡献指南

1. Fork本项目
2. 创建特性分支
3. 提交更改
4. 推送到分支
5. 创建Pull Request

## 许可证

本项目采用MIT许可证 - 详见LICENSE文件

## 联系方式

如有问题或建议，请联系项目维护者。

---

*最后更新: 2025-05-27* 